<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#CFD8DC">
    <title>Yeah¬°</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div id="background"></div>

    <div id="cardStack">
        
        <div class="card" data-position="0" data-card="map">
            <div class="card-header">
                <h1>Yeah¬°</h1>
                <div class="card-indicator">
                    <span class="dot active"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
                </div>
            </div>
            <div class="card-content">
                <div id="map" class="map-home"></div>
                <div id="quickStats" class="quick-stats"></div>
            </div>
        </div>

        <div class="card" data-position="1" data-card="checkin">
            <div class="card-header">
                <h1 id="cardTitleCheckin">Nuevo Yeah¬°</h1>
                <div class="card-indicator">
                    <span class="dot"></span><span class="dot active"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
                </div>
            </div>
            <div class="card-content">
                <div id="mapPreview" class="map-preview"></div>
                
                <div class="form-section">
                    <div style="display: flex; gap:0.5rem">
                        <input type="text" id="placeSearch" placeholder="üîç Buscar lugar cercano..." style="margin-bottom:0">
                     </div>
                    <div id="placeResults" class="place-results"></div>
                </div>

                <div class="form-section" style="margin-top: 1rem;">
                    <label for="placeNote">Nota</label>
                    <textarea id="placeNote" rows="3" placeholder="Cu√©ntame m√°s..."></textarea>
                </div>

                <div class="form-section">
                    <label for="photoInput">A√±adir Foto</label>
                    <input type="file" id="photoInput" accept="image/*">
                    <img id="photoPreview" src="#" alt="Vista previa" style="display: none; width: 100%; max-height: 200px; object-fit: cover; border-radius: 12px; margin-top: 1rem;">
                </div>

                <button id="saveCheckin" class="btn-primary">Guardar Yeah¬°</button>
            </div>
        </div>

        <div class="card" data-position="2" data-card="history">
            <div class="card-header">
                <h1>Historial</h1>
                <div class="card-indicator">
                    <span class="dot"></span><span class="dot"></span><span class="dot active"></span><span class="dot"></span><span class="dot"></span>
                </div>
            </div>
            <div class="card-content">
                <div class="filter-section">
                    <input type="text" id="searchFilter" placeholder="Buscar en tu historial...">
                    <select id="sortFilter">
                        <option value="newest">M√°s recientes</option>
                        <option value="oldest">M√°s antiguos</option>
                    </select>
                </div>

                <div id="checkinsList" class="checkins-list"></div>
                <div id="emptyState" class="empty-state" style="display: none;">
                    <p>No hay Yeahs que coincidan</p>
                </div>
            </div>
        </div>

        <div class="card" data-position="3" data-card="stats">
            <div class="card-header">
                <h1>Estad√≠sticas</h1>
                <div class="card-indicator">
                    <span class="dot"></span><span class="dot"></span><span class="dot active"></span><span class="dot"></span><span class="dot"></span>
                </div>
            </div>
            <div class="card-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="statTotal">0</div>
                        <div class="stat-label">Check-ins</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statPlaces">0</div>
                        <div class="stat-label">Lugares</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statPhotos">0</div>
                        <div class="stat-label">Fotos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statNotes">0</div>
                        <div class="stat-label">Notas</div>
                    </div>
                </div>
                <div class="stats-section">
                    <h2>Lugares top</h2>
                    <div id="topPlaces" class="top-list"></div>
                </div>
                <div class="stats-section">
                    <h2>Por mes</h2>
                    <div id="monthlyChart" class="chart"></div>
                </div>
                <div class="stats-section">
                    <h2>Por d√≠a</h2>
                    <div id="weekdayChart" class="chart"></div>
                </div>
                <div class="stats-section">
                    <h2>Mapa de calor</h2>
                    <div id="heatMap" class="map-heat"></div>
                </div>
            </div>
        </div>

        <div class="card" data-position="4" data-card="settings">
            <div class="card-header">
                <h1>Ajustes</h1>
                <div class="card-indicator">
                    <span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot active"></span>
                </div>
            </div>
            <div class="card-content">
                <div class="stats-section">
                    <h2>Exportar Datos</h2>
                    <p style="color:var(--text-secondary); margin-bottom:1rem; font-size:0.9rem;">Guarda tus recuerdos fuera de la app.</p>
                    <div style="display:grid; gap:0.8rem;">
                        <button id="exportCSV" class="btn-secondary">üìÑ Descargar CSV (Excel)</button>
                        <button id="exportICal" class="btn-secondary">üìÖ Descargar iCal (Calendario)</button>
                        <button id="exportJSON" class="btn-secondary">üì¶ Copia de Seguridad (JSON)</button>
                    </div>
                </div>

                <div class="stats-section" style="margin-top:1.5rem">
                    <h2>Importar</h2>
                    <p style="color:var(--text-secondary); margin-bottom:1rem; font-size:0.9rem;">Restaura una copia de seguridad JSON.</p>
                    <input type="file" id="importFile" accept=".json" style="display: none;">
                    <button id="importJSON" class="btn-primary">üì• Importar Copia de Seguridad</button>
                </div>
            </div>
        </div>

    </div>

    <dialog id="detailsModal" class="modal">
        <div class="modal-header">
            <h2>Detalles del Yeah¬°</h2>
            <button class="btn-icon" onclick="closeDetails()" style="width:32px; height:32px; background:#ECEFF1;">‚úï</button>
        </div>
        <div id="detailsMap" class="map-preview" style="height: 250px; border-radius: 0;"></div>
        <div class="modal-content">
            <div id="detailsPhotoContainer" style="display: none; margin-bottom: 1rem;">
                <img id="detailsPhoto" src="#" alt="Foto del Yeah" style="width: 100%; border-radius: 12px; object-fit: cover;">
            </div>
            <div id="detailsInfo"></div>
            <div class="modal-actions">
                <button id="btnEdit" class="btn-secondary" style="flex:1">‚úèÔ∏è Editar</button>
                <button id="btnDelete" class="btn-secondary" style="flex:1; color:var(--danger-color); border-color:#FFEBEE; background:#FFEBEE;">üóëÔ∏è Borrar</button>
            </div>
        </div>
    </dialog>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-heat@0.2.0/dist/leaflet-heat.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/maps.js"></script>
    <script src="js/app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
